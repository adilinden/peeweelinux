<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> Uncompressed root fs to ramdisk.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:PeeWeeLinux%40adis.on.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000037.html">
   <LINK REL="Next"  HREF="000039.html">
<!-- Google_Analytics -->
 </HEAD>
 <BODY BGCOLOR="#ffffff">
<!-- AdSense_Archive_Slot -->
   <H1>Uncompressed root fs to ramdisk.
   </H1>
    <B>Mattias Sjogren
    </B> 
    <A HREF="mailto:PeeWeeLinux%40adis.on.ca"
       TITLE="Uncompressed root fs to ramdisk.">PeeWeeLinux@adis.on.ca
       </A><BR>
    <I>Tue, 23 May 2000 23:07:46 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000037.html">Uncompressed root fs to ramdisk.
</A></li>
        <LI> Next message: <A HREF="000039.html">Uncompressed root fs to ramdisk.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38">[ date ]</a>
              <a href="thread.html#38">[ thread ]</a>
              <a href="subject.html#38">[ subject ]</a>
              <a href="author.html#38">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alright! I'll give it a try in a minute, we have to sort out
some problem with the powersupply (batteries) to our
computer first...

We have the default 4 MB's ramdisks. As far as I know the
ramdisks are created at boot (16 at 4MB a piece). I just
create them with mke2fs -m0 /dev/ram0...2.

I'll see if I can login with an ordinary user...

/Mattias

Ralph Stickley &lt;<A HREF="mailto:r_stickley@yahoo.com">r_stickley@yahoo.com</A>&gt; skrev:
&gt;<i> Good Job!
</I>&gt;<i> 
</I>&gt;<i> Not sure about the minigetty thing.  I think the /dev/tty
</I>&gt;<i> things (are they
</I>&gt;<i> files , pipes ? does anybody know ?? ) have to be in R/W
</I>&gt;<i> partition. I just
</I>&gt;<i> linked to my ram disk:
</I>&gt;<i> 
</I>&gt;<i> mount /dev/ram /var
</I>&gt;<i> /tmp -&gt; /var
</I>&gt;<i> /dev/tty0 -&gt; /tmp/tty0
</I>&gt;<i> ...
</I>&gt;<i> 
</I>&gt;<i> Where /tmp is a link to the /var mount point for the ram
</I>&gt;<i> disk. That might help
</I>&gt;<i> ?
</I>&gt;<i> 
</I>&gt;<i> Do you create more than one ramdisk ? How do you specify
</I>&gt;<i> the size of your ram
</I>&gt;<i> disk ?
</I>&gt;<i> 
</I>&gt;<i> BTW, If I don't login with root privledge, I can never
</I>&gt;<i> get my console window to
</I>&gt;<i> open. (Something to do with ttyP0 and ptyp0 I think...)
</I>&gt;<i> 
</I>&gt;<i> Little bits here and there to clean up yet....so little
</I>&gt;<i> time :-)
</I>&gt;<i> 
</I>&gt;<i> Good luck,
</I>&gt;<i> Ralph
</I>&gt;<i> 
</I>&gt;<i> --- Mattias Sjogren &lt;<A HREF="mailto:mattias@voxway.com">mattias@voxway.com</A>&gt; wrote:
</I>&gt;<i> &gt; After some minor initial problems we're now up and
</I>&gt;<i> &gt; running... Our only remaining problem is that mingetty
</I>&gt;<i> does
</I>&gt;<i> &gt; not like to be run from the read-only disk. Init says
</I>&gt;<i> that
</I>&gt;<i> &gt; it respawned too many times.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I have /var (inc a touched run/utmp), /tmp and /root as
</I>&gt;<i> &gt; mounted ramdisks. I boot of one big partition that I
</I>&gt;<i> want
</I>&gt;<i> &gt; read-only.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; /Mattias
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Ralph Stickley &lt;<A HREF="mailto:r_stickley@yahoo.com">r_stickley@yahoo.com</A>&gt; skrev:
</I>&gt;<i> &gt; &gt; Hi,
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; The solution I used to protect the system (copied
</I>&gt;<i> from
</I>&gt;<i> &gt; &gt; some other
</I>&gt;<i> &gt; &gt; distributions):
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Format the Compact Flash as follows:
</I>&gt;<i> &gt; &gt; 1. hdx1 Create a boot partition (~1MB)
</I>&gt;<i> &gt; &gt; 2. hdx2 Create a Read Only partition (~28MB)
</I>&gt;<i> &gt; &gt; 3. hdx3 Create a Read/Write partition (~1MB)
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Now load each partition:
</I>&gt;<i> &gt; &gt; 1. hdx1 Copy boot.b and kernel-2.2.14 (or whatever
</I>&gt;<i> your
</I>&gt;<i> &gt; &gt; image is)
</I>&gt;<i> &gt; &gt; 2. hdx2 Copy all files here
</I>&gt;<i> &gt; &gt; 3. hdx3 format/erase
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Now run LiLo and tell it where the boot image is
</I>&gt;<i> &gt; &gt; (/dev/hdx1) 
</I>&gt;<i> &gt; &gt; and where the file system is (root=/dev/hdx2)
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Note fstab never has to mount the boot partition. All
</I>&gt;<i> &gt; &gt; system files are
</I>&gt;<i> &gt; &gt; maintained on the read only partition and never get
</I>&gt;<i> &gt; &gt; corrupted. User files are
</I>&gt;<i> &gt; &gt; vulenerable, but can be backed up on-to the Read only
</I>&gt;<i> &gt; &gt; partition as required.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; The trickery is all in rc.sysinit. At boot up, you
</I>&gt;<i> have
</I>&gt;<i> &gt; &gt; to mount everything
</I>&gt;<i> &gt; &gt; and then load the default files to the read/write
</I>&gt;<i> &gt; &gt; partition. This
</I>&gt;<i> &gt; &gt; needs to be checked and reformatted if it gets
</I>&gt;<i> corrupted.
</I>&gt;<i> &gt; &gt; I also create a ramdisk to store the /tmp /var
</I>&gt;<i> /whatever
</I>&gt;<i> &gt; &gt; files in.
</I>&gt;<i> &gt; &gt; this gives about 4MB of space to let the system store
</I>&gt;<i> &gt; &gt; stuff.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Some files on the Read Only partition may need to be
</I>&gt;<i> &gt; &gt; updated on
</I>&gt;<i> &gt; &gt; occasion.  A simple script will allow access to do
</I>&gt;<i> this 
</I>&gt;<i> &gt; &gt; (mount -o remount...).
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; So far, this works for me, doesn't take much ram.  I
</I>&gt;<i> &gt; &gt; don't know how
</I>&gt;<i> &gt; &gt; to get the permissions set properly, how to get the
</I>&gt;<i> &gt; &gt; devices to work
</I>&gt;<i> &gt; &gt; everytime and other little problems....
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; The applications I have working (on 32MB CF) so far:
</I>&gt;<i> &gt; &gt; Netscape 4.7/Citrix/x3270/fvwm95
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; All system configuration is done through fvwm scripts
</I>&gt;<i> &gt; &gt; (clock, mouse,
</I>&gt;<i> &gt; &gt; keyboard, beep, network, startup applications, screen
</I>&gt;<i> &gt; &gt; background).
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Hope this helps,
</I>&gt;<i> &gt; &gt; Ralph
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; --- Mattias Sjogren &lt;<A HREF="mailto:mattias@voxway.com">mattias@voxway.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; Hi all!
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; I have just got going with PeeWee Linux and it
</I>&gt;<i> looks
</I>&gt;<i> &gt; &gt; great
</I>&gt;<i> &gt; &gt; &gt; so far... My only problem is that I want to load
</I>&gt;<i> the
</I>&gt;<i> &gt; &gt; &gt; uncompressed root filesystem to ram to avoid
</I>&gt;<i> corruption
</I>&gt;<i> &gt; &gt; on
</I>&gt;<i> &gt; &gt; &gt; sudden power failures. I know that this is easily
</I>&gt;<i> done
</I>&gt;<i> &gt; &gt; with
</I>&gt;<i> &gt; &gt; &gt; a compressed root fs but that makes it so hard to
</I>&gt;<i> &gt; &gt; change so
</I>&gt;<i> &gt; &gt; &gt; I don't want that.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; I'm booting from a 16MB Flash pcmcia card in an ide
</I>&gt;<i> &gt; &gt; adaptor
</I>&gt;<i> &gt; &gt; &gt; using LILO. 
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Another small question... How do I get the statup
</I>&gt;<i> &gt; &gt; scripts to
</I>&gt;<i> &gt; &gt; &gt; automatically run fsck on the root fs? I have a '1'
</I>&gt;<i> at
</I>&gt;<i> &gt; &gt; the
</I>&gt;<i> &gt; &gt; &gt; right place in fstab but that doesn't help and I
</I>&gt;<i> get no
</I>&gt;<i> &gt; &gt; &gt; errors...
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; Don't know, I have the same problem...some option in
</I>&gt;<i> &gt; &gt; mount I suppose...
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; __________________________________________________
</I>&gt;<i> &gt; &gt; Do You Yahoo!?
</I>&gt;<i> &gt; &gt; Send instant messages &amp; get email alerts with Yahoo!
</I>&gt;<i> &gt; &gt; Messenger.
</I>&gt;<i> &gt; &gt; <A HREF="http://im.yahoo.com/">http://im.yahoo.com/</A>
</I>&gt;<i> &gt; &gt; ---------------------------------------------------
</I>&gt;<i> &gt; &gt; See the list archives at <A HREF="http://adis.on.ca/archives/">http://adis.on.ca/archives/</A>
</I>&gt;<i> &gt; &gt; See the PWL homepage at  <A HREF="http://embedded.adis.on.ca">http://embedded.adis.on.ca</A>
</I>&gt;<i> &gt; &gt; ---------------------------------------------------
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; <A HREF="http://www.docs.uu.se/robocup/">http://www.docs.uu.se/robocup/</A>
</I>&gt;<i> &gt; ---------------------------------------------------
</I>&gt;<i> &gt; See the list archives at <A HREF="http://adis.on.ca/archives/">http://adis.on.ca/archives/</A>
</I>&gt;<i> &gt; See the PWL homepage at  <A HREF="http://embedded.adis.on.ca">http://embedded.adis.on.ca</A>
</I>&gt;<i> &gt; ---------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> __________________________________________________
</I>&gt;<i> Do You Yahoo!?
</I>&gt;<i> Send instant messages &amp; get email alerts with Yahoo!
</I>&gt;<i> Messenger.
</I>&gt;<i> <A HREF="http://im.yahoo.com/">http://im.yahoo.com/</A>
</I>&gt;<i> ---------------------------------------------------
</I>&gt;<i> See the list archives at <A HREF="http://adis.on.ca/archives/">http://adis.on.ca/archives/</A>
</I>&gt;<i> See the PWL homepage at  <A HREF="http://embedded.adis.on.ca">http://embedded.adis.on.ca</A>
</I>&gt;<i> ---------------------------------------------------
</I>
<A HREF="http://www.docs.uu.se/robocup/">http://www.docs.uu.se/robocup/</A>
---------------------------------------------------
See the list archives at <A HREF="http://adis.on.ca/archives/">http://adis.on.ca/archives/</A>
See the PWL homepage at  <A HREF="http://embedded.adis.on.ca">http://embedded.adis.on.ca</A>
---------------------------------------------------

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000037.html">Uncompressed root fs to ramdisk.
</A></li>
	<LI> Next message: <A HREF="000039.html">Uncompressed root fs to ramdisk.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38">[ date ]</a>
              <a href="thread.html#38">[ thread ]</a>
              <a href="subject.html#38">[ subject ]</a>
              <a href="author.html#38">[ author ]</a>
         </LI>
       </UL>
</body></html>
