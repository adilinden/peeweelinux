<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> Uncompressed root fs to ramdisk.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:PeeWeeLinux%40adis.on.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000035.html">
   <LINK REL="Next"  HREF="000037.html">
<!-- Google_Analytics -->
 </HEAD>
 <BODY BGCOLOR="#ffffff">
<!-- AdSense_Archive_Slot -->
   <H1>Uncompressed root fs to ramdisk.
   </H1>
    <B>Mattias Sjogren
    </B> 
    <A HREF="mailto:PeeWeeLinux%40adis.on.ca"
       TITLE="Uncompressed root fs to ramdisk.">PeeWeeLinux@adis.on.ca
       </A><BR>
    <I>Tue, 23 May 2000 21:49:45 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000035.html">Uncompressed root fs to ramdisk.
</A></li>
        <LI> Next message: <A HREF="000037.html">Uncompressed root fs to ramdisk.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>After some minor initial problems we're now up and
running... Our only remaining problem is that mingetty does
not like to be run from the read-only disk. Init says that
it respawned too many times.

I have /var (inc a touched run/utmp), /tmp and /root as
mounted ramdisks. I boot of one big partition that I want
read-only.

/Mattias

Ralph Stickley &lt;<A HREF="mailto:r_stickley@yahoo.com">r_stickley@yahoo.com</A>&gt; skrev:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> The solution I used to protect the system (copied from
</I>&gt;<i> some other
</I>&gt;<i> distributions):
</I>&gt;<i> 
</I>&gt;<i> Format the Compact Flash as follows:
</I>&gt;<i> 1. hdx1 Create a boot partition (~1MB)
</I>&gt;<i> 2. hdx2 Create a Read Only partition (~28MB)
</I>&gt;<i> 3. hdx3 Create a Read/Write partition (~1MB)
</I>&gt;<i> 
</I>&gt;<i> Now load each partition:
</I>&gt;<i> 1. hdx1 Copy boot.b and kernel-2.2.14 (or whatever your
</I>&gt;<i> image is)
</I>&gt;<i> 2. hdx2 Copy all files here
</I>&gt;<i> 3. hdx3 format/erase
</I>&gt;<i> 
</I>&gt;<i> Now run LiLo and tell it where the boot image is
</I>&gt;<i> (/dev/hdx1) 
</I>&gt;<i> and where the file system is (root=/dev/hdx2)
</I>&gt;<i> 
</I>&gt;<i> Note fstab never has to mount the boot partition. All
</I>&gt;<i> system files are
</I>&gt;<i> maintained on the read only partition and never get
</I>&gt;<i> corrupted. User files are
</I>&gt;<i> vulenerable, but can be backed up on-to the Read only
</I>&gt;<i> partition as required.
</I>&gt;<i> 
</I>&gt;<i> The trickery is all in rc.sysinit. At boot up, you have
</I>&gt;<i> to mount everything
</I>&gt;<i> and then load the default files to the read/write
</I>&gt;<i> partition. This
</I>&gt;<i> needs to be checked and reformatted if it gets corrupted.
</I>&gt;<i> I also create a ramdisk to store the /tmp /var /whatever
</I>&gt;<i> files in.
</I>&gt;<i> this gives about 4MB of space to let the system store
</I>&gt;<i> stuff.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Some files on the Read Only partition may need to be
</I>&gt;<i> updated on
</I>&gt;<i> occasion.  A simple script will allow access to do this 
</I>&gt;<i> (mount -o remount...).
</I>&gt;<i> 
</I>&gt;<i> So far, this works for me, doesn't take much ram.  I
</I>&gt;<i> don't know how
</I>&gt;<i> to get the permissions set properly, how to get the
</I>&gt;<i> devices to work
</I>&gt;<i> everytime and other little problems....
</I>&gt;<i> 
</I>&gt;<i> The applications I have working (on 32MB CF) so far:
</I>&gt;<i> Netscape 4.7/Citrix/x3270/fvwm95
</I>&gt;<i> 
</I>&gt;<i> All system configuration is done through fvwm scripts
</I>&gt;<i> (clock, mouse,
</I>&gt;<i> keyboard, beep, network, startup applications, screen
</I>&gt;<i> background).
</I>&gt;<i> 
</I>&gt;<i> Hope this helps,
</I>&gt;<i> Ralph
</I>&gt;<i> 
</I>&gt;<i> --- Mattias Sjogren &lt;<A HREF="mailto:mattias@voxway.com">mattias@voxway.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi all!
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I have just got going with PeeWee Linux and it looks
</I>&gt;<i> great
</I>&gt;<i> &gt; so far... My only problem is that I want to load the
</I>&gt;<i> &gt; uncompressed root filesystem to ram to avoid corruption
</I>&gt;<i> on
</I>&gt;<i> &gt; sudden power failures. I know that this is easily done
</I>&gt;<i> with
</I>&gt;<i> &gt; a compressed root fs but that makes it so hard to
</I>&gt;<i> change so
</I>&gt;<i> &gt; I don't want that.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I'm booting from a 16MB Flash pcmcia card in an ide
</I>&gt;<i> adaptor
</I>&gt;<i> &gt; using LILO. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Another small question... How do I get the statup
</I>&gt;<i> scripts to
</I>&gt;<i> &gt; automatically run fsck on the root fs? I have a '1' at
</I>&gt;<i> the
</I>&gt;<i> &gt; right place in fstab but that doesn't help and I get no
</I>&gt;<i> &gt; errors...
</I>&gt;<i> &gt; 
</I>&gt;<i> Don't know, I have the same problem...some option in
</I>&gt;<i> mount I suppose...
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> __________________________________________________
</I>&gt;<i> Do You Yahoo!?
</I>&gt;<i> Send instant messages &amp; get email alerts with Yahoo!
</I>&gt;<i> Messenger.
</I>&gt;<i> <A HREF="http://im.yahoo.com/">http://im.yahoo.com/</A>
</I>&gt;<i> ---------------------------------------------------
</I>&gt;<i> See the list archives at <A HREF="http://adis.on.ca/archives/">http://adis.on.ca/archives/</A>
</I>&gt;<i> See the PWL homepage at  <A HREF="http://embedded.adis.on.ca">http://embedded.adis.on.ca</A>
</I>&gt;<i> ---------------------------------------------------
</I>
<A HREF="http://www.docs.uu.se/robocup/">http://www.docs.uu.se/robocup/</A>
---------------------------------------------------
See the list archives at <A HREF="http://adis.on.ca/archives/">http://adis.on.ca/archives/</A>
See the PWL homepage at  <A HREF="http://embedded.adis.on.ca">http://embedded.adis.on.ca</A>
---------------------------------------------------

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000035.html">Uncompressed root fs to ramdisk.
</A></li>
	<LI> Next message: <A HREF="000037.html">Uncompressed root fs to ramdisk.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>
</body></html>
